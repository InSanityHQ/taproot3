<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-01-05 Wed 10:16 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cryptography</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Houjun Liu" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="/global.css" type="text/css"/>
<link rel="stylesheet" href="/admonition.css" type="text/css"/>
<link rel="stylesheet" href="https://quantumish.github.io/admonition.css" />
<script src="https://kit.fontawesome.com/76c5ce8bda.js" crossorigin="anonymous" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js", "[Contrib]/siunitx/siunitx.js", "[Contrib]/mhchem/mhchem.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        TeX: {extensions: ["AMSmath.js","AMSsymbols.js",  "[Contrib]/siunitx/siunitx.js", "[Contrib]/mhchem/mhchem.js"]},
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<div class="header"><span class="site"><a href="https://taproot3.sanity.gq">TR3.5</a></span></div><div class="datarow"><h1 class="title">Cryptography</h1> <h2 class="subtitle"></h2> <span class="author">Houjun Liu</span> <span class="date">2022-01-05 Wed 10:16</date></div>
</div>
<div id="content">
<div id="linktables"><div id="table-of-backlinks"><h2>Backlinks</h2><ul><li><a class='backlink' href='KBhintersession_index.html'>Intersession Index</a></li> </ul></div><div id="table-of-contents"><h2>Table of Contents</h2><div id="text-table-of-contents">
<ul>
<li><a href="#org00b3d0c">1. Persons of Interest</a>
<ul>
<li><a href="#org4d9acc4">1.1. Protagonists</a></li>
<li><a href="#org9abf95c">1.2. Antagonists</a></li>
</ul>
</li>
<li><a href="#org90fa219">2. Classical Cryptography</a>
<ul>
<li><a href="#org66986fb">2.1. Caesar Cipher</a>
<ul>
<li><a href="#org1a8e679">2.1.1. Algorithm</a></li>
<li><a href="#org9b8a248">2.1.2. Collisions</a></li>
<li><a href="#org1813766">2.1.3. Example</a></li>
</ul>
</li>
<li><a href="#orgb74c836">2.2. Substitution Cipher</a>
<ul>
<li><a href="#org3bdb944">2.2.1. Algorithm</a></li>
<li><a href="#orgdbc5efc">2.2.2. Helping Eve</a></li>
</ul>
</li>
<li><a href="#org4ea2107">2.3. Vigeniere Cipher</a>
<ul>
<li><a href="#org38d7765">2.3.1. Algorithum</a></li>
<li><a href="#orga2926b1">2.3.2. Alternative</a></li>
<li><a href="#org569bd13">2.3.3. Helping Eve</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgc1b40d1">3. Modern Cryptography</a>
<ul>
<li><a href="#orgd4285c6">3.1. A Number Theory Detour</a>
<ul>
<li><a href="#org6fe711c">3.1.1. Modular Arithmetic</a></li>
</ul>
</li>
<li><a href="#orge500a0b">3.2. Diffe-Helman</a>
<ul>
<li><a href="#orgf35af3c">3.2.1. Discrete Logarithm Problem</a></li>
<li><a href="#org5655fad">3.2.2. El Gamal Crypto</a></li>
</ul>
</li>
<li><a href="#org2a6f682">3.3. RSA</a>
<ul>
<li><a href="#org3fab810">3.3.1. Stupid Uses of RSA</a></li>
<li><a href="#orgb8c98e0">3.3.2. Fixing Stupid RSA: Padding</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></div>
</div>

<div id="outline-container-org00b3d0c" class="outline-2">
<h2 id="org00b3d0c"><span class="section-number-2">1</span> Persons of Interest</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org4d9acc4" class="outline-3">
<h3 id="org4d9acc4"><span class="section-number-3">1.1</span> Protagonists</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>"Alice": person who sends the messages</li>
<li>"Bob": recipient of the messages</li>
</ul>
</div>
</div>

<div id="outline-container-org9abf95c" class="outline-3">
<h3 id="org9abf95c"><span class="section-number-3">1.2</span> Antagonists</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>"Eve": the eavesdropper between Alice =&gt; Bob</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org90fa219" class="outline-2">
<h2 id="org90fa219"><span class="section-number-2">2</span> Classical Cryptography</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org66986fb" class="outline-3">
<h3 id="org66986fb"><span class="section-number-3">2.1</span> Caesar Cipher</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Julius Ceaser's favourite means of cryptography was the "Caesar Cipher".
</p>
</div>

<div id="outline-container-org1a8e679" class="outline-4">
<h4 id="org1a8e679"><span class="section-number-4">2.1.1</span> Algorithm</h4>
<div class="outline-text-4" id="text-2-1-1">
<ol class="org-ol">
<li>Pick a number \(s\)</li>
<li>Shift every letter forward by \(s\), we might have to wrap around ("y" shifted by \(3\) is "b")</li>
</ol>
</div>
</div>

<div id="outline-container-org9b8a248" class="outline-4">
<h4 id="org9b8a248"><span class="section-number-4">2.1.2</span> Collisions</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
Sometimes, words could collide. The words "SLEEP" and "BUNNY" are related to each other by exactly a ceaser cipher.
</p>
</div>
</div>

<div id="outline-container-org1813766" class="outline-4">
<h4 id="org1813766"><span class="section-number-4">2.1.3</span> Example</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
Plaintext: "Cryptography is Fun". Set \(s=5\).
Ciphertext: "HWDUYTLWFUMD NX KZS"
</p>

<p>
To recover the original message, just shift letters down by \(s\).
</p>
</div>
</div>
</div>

<div id="outline-container-orgb74c836" class="outline-3">
<h3 id="orgb74c836"><span class="section-number-3">2.2</span> Substitution Cipher</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org3bdb944" class="outline-4">
<h4 id="org3bdb944"><span class="section-number-4">2.2.1</span> Algorithm</h4>
<div class="outline-text-4" id="text-2-2-1">
<ol class="org-ol">
<li>Write down all the plaintext letters: a b c d e f g h i &#x2026; you get the point</li>
<li><p>
Think about a keyword or phrase that pairwise matches them, without repeats and uses all 24 letters
</p>


<div id="org2dd5ec5" class="figure">
<p><img src="2022-01-04_09-01-45_screenshot.png" alt="2022-01-04_09-01-45_screenshot.png" />
</p>
</div></li>

<li><p>
Then, pariwise match them
</p>

<div id="orgf673fed" class="figure">
<p><img src="2022-01-04_09-02-43_screenshot.png" alt="2022-01-04_09-02-43_screenshot.png" />
</p>
</div></li>
</ol>

<p>
If we allow letters to encrypted by themselves, there is one set of possibility allowed.
</p>

<p>
"Any additional structure that you have in an algorithm will help eve."
</p>
</div>
</div>

<div id="outline-container-orgdbc5efc" class="outline-4">
<h4 id="orgdbc5efc"><span class="section-number-4">2.2.2</span> Helping Eve</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
Let's see a bad encryption by the substitution cipher, and see what we could do.
</p>

<p>
"T PXVW X QNIOD CXNVWDEIK RWCEAKQNXQTEA EF QPTK UNEUEKTQTEA"
</p>

<ol class="org-ol">
<li>We have two things: "T" must be "i", "X" must be a "a"</li>
</ol>

<p>
And then, after much consternation
</p>


<div id="orgfc6e94c" class="figure">
<p><img src="2022-01-04_09-28-54_screenshot.png" alt="2022-01-04_09-28-54_screenshot.png" />
</p>
</div>
</div>



<ol class="org-ol">
<li><a id="orgfce119d"></a>Spaces<br />
<div class="outline-text-5" id="text-2-2-2-1">
<p>
We realized that this message is "shockingly" (not really) easy to crack. The spaces is a dead giveaway.
</p>

<p>
Hence, to make messages harder to decrypt, we rid of all the spaces and space the letters out in groups of five.
</p>

<p>
Therefore, we will encode it in the following way instead:
</p>
</div>
</li>


<li><a id="orge24ef60"></a>Frequency Analysis<br />
<div class="outline-text-5" id="text-2-2-2-2">
<p>
"T PXVW X QNIOD CXNVWDEIK RWCEAKQNXQTEA EF QPTK UNEUEKTQTEA" =&gt; "TPXVW XQNIO DCXNV WOEIK RWCEA KQNXQ TEAEF QPTKU NEUEK TQTEA"
</p>

<p>
Now, this is much harder to get rid of. If the substitution cipher is larger, we could do a frequency analysis to get ahead in breaking the cipher.
</p>

<p>
The most frequent letters for frequency analysis (through, deprecated. For the modern convention, look it up.), in decreasing order: ETAOINSHRDLCU.
</p>

<p>
Therefore, if we have a large body of text, we could work it out.
</p>
</div>
</li>

<li><a id="org6420e21"></a>n-Gram Analysis<br />
<div class="outline-text-5" id="text-2-2-2-3">
<p>
Most common bigrams: "TH", "HE"
Most common trigrams: "THE", "AND"
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org4ea2107" class="outline-3">
<h3 id="org4ea2107"><span class="section-number-3">2.3</span> Vigeniere Cipher</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-org38d7765" class="outline-4">
<h4 id="org38d7765"><span class="section-number-4">2.3.1</span> Algorithum</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
Plaintext: "crypt ograph hyisf un"
Key: "LIMEL IMELI MELIM EL"
</p>

<ol class="org-ol">
<li>We first do a ceaser shift</li>
<li>Then perform substitution, shifting the key</li>
<li>Then we shift again</li>
</ol>
</div>
</div>

<div id="outline-container-orga2926b1" class="outline-4">
<h4 id="orga2926b1"><span class="section-number-4">2.3.2</span> Alternative</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Use the key once, then use the plaintext.
</p>
</div>
</div>

<div id="outline-container-org569bd13" class="outline-4">
<h4 id="org569bd13"><span class="section-number-4">2.3.3</span> Helping Eve</h4>
<div class="outline-text-4" id="text-2-3-3">
</div>
<ol class="org-ol">
<li><a id="orgf78707b"></a>Kasiski Examination<br />
<div class="outline-text-5" id="text-2-3-3-1">
<ul class="org-ul">
<li>Look through cipher text and look for any longe strings of repeated letters</li>
<li>The difference between the positions is probably the key length</li>
</ul>

<p>
When you look at repeated strings, could could figure small subsections of repeated values. In our example, its about 6.
</p>

<p>
Guess all possible positions when a common string takes place, and count various small key lengths.
</p>
</div>
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgc1b40d1" class="outline-2">
<h2 id="orgc1b40d1"><span class="section-number-2">3</span> Modern Cryptography</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>Modern Cryptography requires a <i>secure</i> method of exchanging the key to set up a connection</li>
<li>"It doesn't matter if it is impossible to figure out the key, it just has to be highly impractical"</li>
</ul>
</div>

<div id="outline-container-orgd4285c6" class="outline-3">
<h3 id="orgd4285c6"><span class="section-number-3">3.1</span> A Number Theory Detour</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org6fe711c" class="outline-4">
<h4 id="org6fe711c"><span class="section-number-4">3.1.1</span> Modular Arithmetic</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Let \(m \in \mathbb{N}\). If \(a,b\) are integers, we say that \(a,b\) are congruent \(\mod m\) if they have the same remainder if you divide by \(m\). Equivalently, $a,b,$ are congruent \(\mod m\) if \(a-b\) is a multiple of \(m\). We write \(a \equiv b\ (\text{mod}\ m)\).
</p>
</div>

<ol class="org-ol">
<li><a id="orga8a0fcc"></a>Doing Basic Math<br />
<div class="outline-text-5" id="text-3-1-1-1">
<p>
The cool thing is, we could do arithmetic with mods. We could add, subtract, multiply in modular arithmetic. For instance, if we know that \(a \equiv 2\ (\text{mod}\ 8)\) and \(b \equiv 5\ (\text{mod}\ 8)\), we could grantee that \(a+b \equiv 7\ (\text{mod}\ 8)\), \(a-b \equiv -3  \equiv 5 \ (\text{mod}\ 8)\), \(ab \equiv 10 \equiv 2 \ (\text{mod}\ 8)\). 
</p>
</div>
</li>

<li><a id="org70ac51f"></a>Fermat's Little Theorem<br />
<div class="outline-text-5" id="text-3-1-1-2">
<p>
Let \(p\) be a prime.
</p>

<ol class="org-ol">
<li>If \(a\in\mathbb{I}, a \not\equiv 0\ (\text{mod}\ p)\), then \(a^p-1 \equiv 1\ (\text{mod}\ p)\)</li>
<li>If \(a \in \mathbb{I}\), then \(a^p \equiv a\ (\text{mod}\ p)\)</li>
</ol>

<p>
A Proof.
</p>

<p>
Consider the numbers \(a, 2a,3a, \cdots, (p-1)a\). None of them are divisible by \(p\). Furthermore, claim that no two are congruent modulo \(p\). Suppose on the contrary that \(ra \equiv sa\ (\text{mod}\ p)\). Then \((r-s)a \equiv 0\ (\text{mod}\ p)\). But neither factor can be a multiple of \(p\), so this is not possible.
</p>

<p>
Thus, \(a,2a,3a, \ldots, (p-1)a \equiv 1,2,3, \ldots p-1\ (\text{mod}\ p)\).
</p>

<p>
Therefore, \(a, 2a, 3a, \ldots, (p-1)a \equiv 1,2,3,\ldocs, p-1\ (\text{mod}\ p)\) in some order. Thus, \(a \cdot 2a \cdot \ldots (p-1)a = 1 \cdot 2 \cdot 3 \cdots (p-1)\ (\text{mod}\ p)\).. 
</p>

<ul class="org-ul">
<li>\(a^{p-1}(p-1)! \equiv (p-1)!\ (\text{mod}\ p)\)</li>
<li>\((a^{p-1}-1)(p-1)! \equiv 0\ (\text{mod}\ p)\)</li>
<li>\((a^{p-1}) \equiv 1\ (\text{mod}\ p)\)</li>
</ul>
</div>
</li>

<li><a id="orga66ad04"></a>Totient Functions<br />
<div class="outline-text-5" id="text-3-1-1-3">
<p>
Let \(n\) be a positive integer.  The <span class="underline">totient</span> of \(n\), denoted as \(\phi(n)\) is the number of positive integers \(a \leq n\) such that \(gcd(a,n)=1\).
</p>

<p>
E.g \(n=10\), numbers \(\leq 10\) that are relatively prime to \(10\) are \(1,3,7,9\) so \(\phi (10) = 4\).
</p>

<p>
Then, suppose the prime factorization of \(n\) is \(n=p_1^{e_1}p_2^{e_2} \cdots p_r^{er}\) where $p<sub>i</sub>$s are distinct primes and each \(e_i \leq 1\). 
</p>

<p>
Then:
</p>

\begin{equation}
\phi(n) = n(1-\frac{1}{p_1})(1-\frac{1}{p_2})\cdots (1-\frac{1}{p_r})
\end{equation}

<p>
If \(p,q\) are distinct primes, then \(\phi(pq) = (p-1)(q-1)\). 
</p>
</div>
</li>

<li><a id="orge077e98"></a>Euler's Totient Theorem<br />
<div class="outline-text-5" id="text-3-1-1-4">
<p>
If \(gcd(a,n) = 1\), then \(a^{\phi(n)} \equiv 1\ (\text{mod}\ n)\).
</p>
</div>
</li>

<li><a id="org3b20e1b"></a>One more Theorem<br />
<div class="outline-text-5" id="text-3-1-1-5">
<p>
If \(p\) is prime, then there is some integer \(g\), depending on a \(p\) such that \(g,g^2, g^3, \ldots, g^{p-1}\) are all distinct modulo \(p\). Such a number \(g\) is called a primitive root modulo \(p\).
</p>
</div>
</li>

<li><a id="orga890e61"></a>The Euclidean Algorithum<br />
<div class="outline-text-5" id="text-3-1-1-6">
<p>
There is, actually, an easy way of calculating the GCD of two values without factoring them.  \(gcd(a,b) = gcd(a,b-a)\).
</p>

<p>
If \(d\) is any factor of \(a,b\), say \(a=kd\), \(b=ld\). Then \(b-a = (l-k)d\). \(gcd(301,161)=gcd(161,140)=gcd(140,21)=gcd(21,14)=gcd(7,0)=7\). You will realize this is just subtracting gcd together.
</p>
</div>
</li>

<li><a id="org7229303"></a>Bezout's lemma<br />
<div class="outline-text-5" id="text-3-1-1-7">
<p>
If \(a,b\) are integers, then \(gcd(a,b)\) is the smallest positive integer \(d\) such that there exist integers \(x,y\) with \(ax+by=d\).
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orge500a0b" class="outline-3">
<h3 id="orge500a0b"><span class="section-number-3">3.2</span> Diffe-Helman</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Alice computes \(k_1 = B^1 mod\ p\), and Bob computes \(k_2 = A^b\) mod \(p\). \(k_1 = k_2\), so this is a shared piece of information, which can be used as a key.
</p>

<ul class="org-ul">
<li>\(k_1 = B^a \equiv (g^b)^a \equiv g^{ab}\ (\text{mod}\ p)\)</li>
<li>\(k_2 = A^b \equiv (g^a)^b \equiv g^{ab}(\text{mod}\ p)\)</li>
</ul>
</div>

<div id="outline-container-orgf35af3c" class="outline-4">
<h4 id="orgf35af3c"><span class="section-number-4">3.2.1</span> Discrete Logarithm Problem</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Given a prime \(p\), \(a\) primitive root \(g\), and a nonzero residue class \(x\) (mod p), find a number a s.t. \(g^a \equiv x\ (\text{mod}\ p)\).
</p>
</div>
</div>

<div id="outline-container-org5655fad" class="outline-4">
<h4 id="org5655fad"><span class="section-number-4">3.2.2</span> El Gamal Crypto</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
Plaintext message \(m\): number mod \(p\). Bob computes \(b\) secretly and computers \(B=g^b \mod p\) and distributes it. Alice has a plaintext message \(m\) to send to Bob. She picks a random $a$a, and computes \(A=g^a \mod b\) and \(C=B^a m \mod p\).  She sends both \(A\) and \(c\) to Bob.
</p>

<p>
Bob has to recover \(m\) from \(A,c\) and other info he knows. He computes \(m=A^{-b}c \mod p\).  Which is the plaintext.
</p>
</div>
</div>
</div>

<div id="outline-container-org2a6f682" class="outline-3">
<h3 id="org2a6f682"><span class="section-number-3">3.3</span> RSA</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Alice wishes to send a message to Bob.
</p>

<p>
Bob picks two primes, \(p,q\), secret. He then computes \(n=pq\). He also chooses an encryption exponent, \(e\) such that \(gcd(e,\phi(n) = 1\). His public key is \((n,e)\). He can find a number \(d\) such that \(de\equiv 1\mod \phi( n )\). Since \(gcd(e, \phi(n)) = 1\), \(\exists d,k\ s.t.\ de+k \phi(n) =1\).
</p>

<p>
If \(p\) is prime, and \(p+a\), then \(a^{p-1} \equiv 1 \mod p\). So, if I want to check if \(n\) is composite, pick a random \(a\), not a multiple of \(n\), then compute \(a^{n-1}\) and see if its \(1\).
</p>

<p>
Alice wishes to send a plaintext \(m\) to Bob. 
</p>
</div>

<div id="outline-container-org3fab810" class="outline-4">
<h4 id="org3fab810"><span class="section-number-4">3.3.1</span> Stupid Uses of RSA</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
Alice wants to send either a yes or no to bob. Suppose she encodes yes as \(73\), and no as \(149\). She encrypts it, and sends it along to Bob. What's wrong?
</p>

<p>
The number of messages is pretty small, Eve could just try all possible combinations to figure out what the secret is. i.e. try \(73\), then try \(149\).
</p>

<p>
Alice has a long message, some alphabetical message, she converts each digit to a number seperately, then encrypts each number. Then encrypts each number, then sends all these numbers to Bob. 
</p>
</div>
</div>

<div id="outline-container-orgb8c98e0" class="outline-4">
<h4 id="orgb8c98e0"><span class="section-number-4">3.3.2</span> Fixing Stupid RSA: Padding</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
Take your message, then add on 100 random digits in the end. Once you did that, then you encrypt it. Then, Eve can't check every combination.
</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
