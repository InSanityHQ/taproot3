<html><head><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="Huxley Marvit" name="author" /><meta content="A note on Taproot, a connected notes system." name="description" /><title>User Input Validation</title><link href="/static/css/firn_base.css" rel="stylesheet" /><link href="/static/css/prism.css" rel="stylesheet" /><link href="/static/css/global.css" rel="stylesheet" /><link href="/static/css/admonition.css" rel="stylesheet" /><script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        'displayAlign': 'center',
        'displayIndent': '0em',
        'extensions': ['tex2jax.js'],
        'tex2jax': {
        'inlineMath': [ ['$','$'], ['\\(','\\)'] ],
        'processEscapes': true
        },
        'HTML-CSS': { scale: 100,
                        linebreaks: { automatic: 'false' },
                        webFont: 'TeX'
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: 'false' },
              font: 'TeX'},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: 'AMS'},
               MultLineWidth: '85%',
               TagSide: 'right',
               TagIndent: '.8em'
             }})</script></head><body><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js" type="text/javascript"></script><script crossorigin=="anonymous" src="https://kit.fontawesome.com/76c5ce8bda.js"></script><div class="headerline"><a class="wordmark" href="https://taproot3.sanity.gq/" style="border:0">TR3</a></div><main><article class="content rss"><div class="preamble"><h1 class="title">User Input Validation</h1></div><div class="metamble"><span><span>Written by </span><span>Huxley Marvit</span></span></div><div class="notebody"><div><section><p><span>#ret #hw</span></p><hr /></section><div class="firn-headline-section firn-headline-section-1"><h1 class="firn-headline firn-headline-1" id="user-input-validation"><span class="firn-headline-text"><span>User Input Validation</span></span></h1><section></section><div class="firn-headline-section firn-headline-section-2"><h2 class="firn-headline firn-headline-2" id="python-2-script"><span class="firn-headline-text"><span>Python 2 script</span></span></h2><section><p><span>Suppose someone had a very simple Python 2 script that they ran on their
computer:</span></p><pre class="language-python"><code class="language-python">  # original script
  favorite = input('What is your favorite number? ') # vulnerability in input
  print 'I like the number {}, too!'.format(favorite)
</code></pre><p><span>Show examples of input that would give you access to information that
user had access to (e.g. the contents of a file on their machine).</span></p><pre class="language-shell"><code class="language-shell">  > python2 bad_input.py
  What is your favorite number? open("/Users/huxmarv/super_secret_secrets.txt").read() 
  I like the number password123, too!
</code></pre><p><span>Updated script:</span></p><pre class="language-python"><code class="language-python">  # secure script
  favorite = raw_input('What is your favorite number? ') # change input to raw input
  print 'I like the number {}, too!'.format(favorite)
</code></pre><pre class="language-shell"><code class="language-shell">  > python2 better_input.py
  What is your favorite number? open("/Users/huxmarv/super_secret_secrets.txt").read() 
  I like the number open("/Users/huxmarv/super_secret_secrets.txt").read(), too!
</code></pre><p><span>Breaks:</span><a class="firn-external" href="https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?sectionNum=502.&amp;lawCode=PEN" target="_blank">California
Legislative Information</a><span> > (502c) Knowingly and without permission
disrupts or causes the disruption of computer services or denies or
causes the denial of computer services to an authorized user of a
computer, computer system, or computer network</span></p></section></div><div class="firn-headline-section firn-headline-section-2"><h2 class="firn-headline firn-headline-2" id="cross-site-scripting"><span class="firn-headline-text"><span>Cross-site scripting</span></span></h2><section><p><a class="firn-external" href="https://jennselby.github.io/ComputerSecurityCourseNotes/assets/code/comments.html" target="_blank">Vulnerable
site</a></p><p><span>Write a comment that will cause some JavaScript to run.</span></p><p><span>Updated site:</span></p><pre class="language-js"><code class="language-js">  var textDiv = document.createElement('div');
  //textDiv.innerHTML = document.getElementById('commentText').value;
  textDiv.innerText = document.getElementById('commentText').value; // change innerHTML to innerText
  newDiv.appendChild(textDiv);
</code></pre><p><span>Breaks:</span><a class="firn-external" href="https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?sectionNum=502.&amp;lawCode=PEN" target="_blank">California
Legislative Information</a><span> > (502c) Knowingly and without permission
disrupts or causes the disruption of computer services or denies or
causes the denial of computer services to an authorized user of a
computer, computer system, or computer network</span></p></section></div><div class="firn-headline-section firn-headline-section-2"><h2 class="firn-headline firn-headline-2" id="buffer-overflow"><span class="firn-headline-text"><span>Buffer overflow</span></span></h2><section><p><span>Try to give a password that is not the correct one but does grant you
access.</span></p><pre class="language-C"><code class="language-C">  // from http://stackoverflow.com/questions/34247068/buffer-overflow-does-not-work-on-mac-osx-el-capitan
  #include "stdio.h"
  #include "string.h"

  int check_authentication(char *password) {
      int auth_flag = 0;
      char password_buffer[20]; // vulnerability


      strcpy(password_buffer, password);

      if (strcmp(password_buffer, "password") == 0) { // correct password: password
          auth_flag = 1;
      }

      return auth_flag;
  }

  int main(int argc, char* argv[]) {
      if (argc < 2) {
          printf("Usage: %s <password>\n", argv[0]);
      }

      if (check_authentication(argv[1])) {
          printf("Access Granted.\n");
      } else {
          printf("Access Denied.\n");
      }
  }
</code></pre></section></div></div></div></div></article><div class="metapanel"><div class="metalabel">Contents</div><ol><li><a href="#user-input-validation">User Input Validation</a><ol><li><a href="#python-2-script">Python 2 script</a></li><li><a href="#cross-site-scripting">Cross-site scripting</a></li><li><a href="#buffer-overflow">Buffer overflow</a></li></ol></li></ol><div class="metalabel">Backlinks</div><ul class="firn-backlinks"><li class="firn-backlink"><a href="/cs/computer_security/index">CS240 Master Index</a></li></ul></div></main></body></html>